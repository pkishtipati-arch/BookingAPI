image: mcr.microsoft.com/dotnet/sdk:8.0

stages:
  - test

variables:
  DOTNET_CLI_TELEMETRY_OPTOUT: 1

test:
  stage: test
  script:
    - dotnet restore
    - dotnet build --configuration Release
    - dotnet test --configuration Release --logger "trx;LogFileName=test-results.trx" --logger "html;LogFileName=test-results.html" --results-directory ./TestResults
    - echo "Listing TestResults directory:"
    - ls -la TestResults/
  artifacts:
    when: always
    paths:
      - TestResults/
    reports:
      junit: TestResults/*.trx
    expire_in: 30 days
